<!DOCTYPE html>
<html lang="en">
  <head>
    <%- include('./partials/head.ejs') %>
    <title>Blog</title>
  </head>
  <body>
    <%- include('./partials/nav.ejs') %>
    <div class="container mt-5">
      <h1><%- blog.title %></h1>
      <img src="<%- blog.coverImage %>" width="600px" />
      <pre style="white-space: pre-wrap"><%- blog.body %></pre>
    </div>
    <div class="container mt-3">
      <img src="<%- blog.author.profileImage %>" width="100px" />
      <b><%-blog.author.fullName %></b>
    </div>

    <div class="container mt-5">
      <h1>Comments (<%- comments.length %>)</h1>

       <% comments.forEach(comment => { %>
        <div class="container mt-3">
          <img src="<%- comment.author.profileImage %>" width="40px" /> <%- comment.author.fullName %>
          <p class="card-title"><%- comment.comment %></p>
        </div>
        <% }) %>

      <% if (locals.user) { %>
      <div class="container mt-5">
        <form
          class="row g-3"
          action="/blog/comments/<%- blog._id %>"
          method="post"
        >
          <div class="row">
            <div class="col-sm-10">
              <input
                type="text"
                class="form-control"
                id="comment"
                placeholder="Add a comment"
                name="comment"
              />
            </div>
          </div>
          <div class="col-auto">
            <button type="submit" class="btn btn-primary mb-3">Comment</button>
          </div>
        </form>
      </div>
      <% } %>
    </div>
  </body>
  <%- include('./partials/script.ejs') %>
</html>
